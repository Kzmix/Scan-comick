---
import BaseLayout from "@/layouts/BaseLayout.astro";
import ComicCard from "@/components/comic/ComicCard.astro";
import {
  getAllGenreSlugs,
  getGenreMeta,
  getComicsByGenre,
} from "@/lib/genre";

/* STATIC PATHS: semua genre */
export async function getStaticPaths() {
  return getAllGenreSlugs().map((slug) => ({
    params: { slug },
  }));
}

const { slug } = Astro.params;

const genre = getGenreMeta(slug);
const comics = genre ? getComicsByGenre(slug) : [];
const siteName = "Nama Situs Komik";
const canonical = `https://namasitus.com/genre/${slug}`;
---

<BaseLayout
  title={genre ? `${genre.name} Comics` : "Genre Tidak Ditemukan"}
  description={
    genre
      ? genre.description
      : "Genre yang kamu cari tidak tersedia."
  }
  canonical={canonical}
>
  <main class="bg-zinc-950 text-zinc-100">
    <section class="max-w-7xl mx-auto px-4 py-10">

      {genre ? (
        <>
          <!-- SEO H1 -->
          <h1 class="text-2xl md:text-3xl font-bold">
            {genre.name} Comics
          </h1>

          <p class="mt-2 max-w-2xl text-zinc-400">
            {genre.description}
          </p>

          <!-- LIST KOMIK -->
          <div
            class="mt-8 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4"
          >
            {comics.map((comic) => (
              <ComicCard comic={comic} />
            ))}
          </div>

          {comics.length === 0 && (
            <p class="mt-8 text-zinc-500">
              Belum ada komik untuk genre ini.
            </p>
          )}
        </>
      ) : (
        <!-- GENRE TIDAK ADA (RAMAH USER, BUKAN CRASH) -->
        <>
          <h1 class="text-2xl font-bold">
            Genre Tidak Ditemukan
          </h1>
          <p class="mt-3 text-zinc-400">
            Genre yang kamu cari tidak tersedia.
          </p>

          <a
            href="/genre"
            class="inline-block mt-6 text-sm text-zinc-300 underline"
          >
            Lihat semua genre â†’
          </a>
        </>
      )}

    </section>
  </main>
</BaseLayout>